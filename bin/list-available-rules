#!/usr/bin/env bash
set -euo pipefail

DIR="$(cd "$(dirname "${BASH_SOURCE[0]}")" && pwd)"
PLUGIN=${1:-basic}

[[ "${PLUGIN}" != "basic" ]] || {
    SCRIPT="$(cat <<EOF
let {Linter} = require('eslint');
let rules = new Linter().getRules();
console.log(Array.from(rules.keys()).join('\n'));
EOF
)"
    node -e "${SCRIPT}"
    exit 0
}

cd ${DIR}/..

PLUGIN_PKG=eslint-plugin-${PLUGIN}
RULE_PREFIX=${PLUGIN}/
case ${PLUGIN} in
    proper-arrows)
        PLUGIN_PKG=@getify/eslint-plugin-proper-arrows
        RULE_PREFIX=@getify/proper-arrows/
        ;;
    babel)
        PLUGIN_PKG=@babel/eslint-plugin
        RULE_PREFIX=@babel/
        ;;
    typescript)
        PLUGIN_PKG=@typescript-eslint/eslint-plugin
        RULE_PREFIX=@typescript-eslint/
        ;;
    *)
        ;;
esac

    SCRIPT="$(cat <<EOF
let plugin = require('${PLUGIN_PKG}');
let rules = plugin.rules;
console.log(Object.keys(rules).join('\n'));
EOF
)"
    node -e "${SCRIPT}" | sed "s|^|${RULE_PREFIX}|g"
