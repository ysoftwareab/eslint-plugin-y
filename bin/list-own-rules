#!/usr/bin/env bash
set -euo pipefail

DIR="$(cd "$(dirname "${BASH_SOURCE[0]}")" && pwd)"
CONFIG=${1:-eslint}
# shellcheck disable=SC1091
source ${DIR}/config.inc.sh

[[ -n "${PLUGIN}" ]] || {
    >&2 echo "[WARN] ${CONFIG} is a 0 or multi-plugin config."
    exit 0
}

[[ "${CONFIG}" != "eslint" ]] || {
    SCRIPT="$(cat <<EOF
let {Linter} = require('eslint');
let rules = new Linter().getRules();
console.log(Array.from(rules.keys()).join('\n'));
EOF
)"
    node -e "${SCRIPT}"
    exit 0
}

cd ${DIR}/..

    SCRIPT="$(cat <<EOF
let plugin = require('${PLUGIN}');
let rules = plugin.rules;
console.log(Object.keys(rules).join('\n'));
EOF
)"
    node -e "${SCRIPT}" | sed "s|^|${PLUGIN_RULE_PREFIX}|g" | sort
